---
phase: 03-faq-display
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - app/pages/faqs/index.vue
  - app/pages/faqs/[...slug].vue
  - app/assets/scss/main.scss
autonomous: true

must_haves:
  truths:
    - "User can navigate to /faqs and see a flat list of FAQ questions sorted by most recent"
    - "User can click a FAQ question to view the full answer with source attribution"
    - "Multi-answer FAQs display per-answer source attribution with dividers"
    - "Single-answer FAQs display source attribution from legacy top-level fields"
    - "FAQ detail pages show breadcrumbs (Home > FAQs > Question)"
    - "FAQ detail pages show a back-to-FAQs link and sticky mobile back button"
    - "FAQ listing shows empty state when no FAQs exist"
    - "FAQ detail pages have og:title and og:description from content"
    - "FAQ listing page shows intro text with disclaimer linking to /terms"
    - "FAQ detail pages show subtle disclaimer text"
  artifacts:
    - path: "app/pages/faqs/index.vue"
      provides: "FAQ listing page"
      contains: "queryCollection"
    - path: "app/pages/faqs/[...slug].vue"
      provides: "FAQ detail page with multi-answer, breadcrumbs, SEO"
      contains: "ContentRenderer"
  key_links:
    - from: "app/pages/faqs/index.vue"
      to: "faqs collection"
      via: "queryCollection"
      pattern: "queryCollection.*faqs"
    - from: "app/pages/faqs/index.vue"
      to: "FAQ detail pages"
      via: "NuxtLink with faq.path"
      pattern: ":to=\"faq\\.path\""
    - from: "app/pages/faqs/[...slug].vue"
      to: "faqs collection"
      via: "queryCollection path-based"
      pattern: "queryCollection.*faqs.*path.*first"
    - from: "app/pages/faqs/[...slug].vue"
      to: "/faqs"
      via: "back link and breadcrumb"
      pattern: 'to="/faqs"'
    - from: "app/pages/faqs/[...slug].vue"
      to: "/terms"
      via: "disclaimer link"
      pattern: 'to="/terms"'
---

<objective>
Build the FAQ listing page at /faqs and overhaul the FAQ detail page with multi-answer rendering, breadcrumbs, back-to-list navigation, sticky mobile back button, SEO meta tags, and disclaimer text.

Purpose: Deliver the core user-facing FAQ browsing experience -- the listing for discovery and the detail page for consuming answers.
Output: FAQ listing page (index.vue), overhauled FAQ detail page ([...slug].vue), supporting SCSS styles.
</objective>

<execution_context>
@/Users/rich/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rich/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-faq-display/03-CONTEXT.md
@.planning/phases/03-faq-display/03-RESEARCH.md
@.planning/phases/03-faq-display/03-01-SUMMARY.md
@.planning/phases/02-content-system/02-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FAQ listing page at /faqs</name>
  <files>
    app/pages/faqs/index.vue
  </files>
  <action>
    Create `app/pages/faqs/index.vue` as the FAQ listing page. This page takes priority over `[...slug].vue` for the exact `/faqs` route (Nuxt route specificity rules).

    Template (Pug):
    1. A `section.section > .container` wrapper (Bulma layout).
    2. Page heading: `h1.title` "Frequently Asked Questions".
    3. Intro paragraph that doubles as the listing-level disclaimer (formal/legal tone). Include a NuxtLink to `/terms` for the full disclaimer. Example text:
       "Community-sourced answers for Acura Integra Type S (DE5) owners. Information is aggregated from forums and owner experiences -- it is not verified, endorsed, or guaranteed. See our [full disclaimer](/terms)."
    4. FAQ list section (when `faqs && faqs.length`):
       - Flat list of question titles as NuxtLinks to `faq.path`.
       - Each item is a block-level link displaying `faq.question`.
       - Clean dividers between items (use a simple bottom border on each item except the last, or `hr` elements).
       - Hover highlight on items (subtle background color change via CSS).
       - Sorted by most recent first (handled in query).
    5. Empty state (when no FAQs): A simple paragraph "No FAQs yet. Check back soon." in muted text.

    Script (TypeScript setup):
    1. Fetch FAQs: `queryCollection('faqs').select('path', 'question', 'lastUpdated').order('lastUpdated', 'DESC').all()`
    2. SEO: `useHead({ title: 'Frequently Asked Questions' })` and `useSeoMeta({ ogTitle: 'Frequently Asked Questions | DE5.org', ogDescription: 'Community-sourced answers to common Acura Integra Type S questions.' })`

    Scoped styles:
    - `.faq-list-item`: block display, padding `vars.$spacing-md vars.$spacing-sm`, border-bottom `1px solid var(--bulma-border)`, text decoration none, color inherit, transition background-color `vars.$transition-fast`.
    - `.faq-list-item:hover`: background-color with subtle highlight (use `var(--bulma-scheme-main-bis)` for theme-aware hover).
    - `.faq-list-item:last-child`: no border-bottom.
    - `.faq-question`: font-weight 500 (Inter medium).

    Key pitfall to avoid: Do NOT create a `pages/faqs.vue` parent layout file. The listing and detail pages are standalone.
  </action>
  <verify>
    Run `yarn dev` and navigate to `/faqs`. Verify:
    - Page shows "Frequently Asked Questions" heading with intro text and disclaimer link.
    - All 3 sample FAQs are listed as clickable links, sorted by most recently updated first.
    - Hover highlight works on list items.
    - Clicking a FAQ navigates to its detail page.
    - Empty state can be verified by temporarily commenting out the FAQ query.
    Run `yarn lint` -- no errors.
  </verify>
  <done>
    FAQ listing page at /faqs shows all FAQ questions as a flat list sorted by most recent first, with intro/disclaimer text, hover highlights, and empty state handling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Overhaul FAQ detail page with multi-answer, breadcrumbs, back navigation, SEO, and disclaimers</name>
  <files>
    app/pages/faqs/[...slug].vue
    app/assets/scss/main.scss
  </files>
  <action>
    Overhaul `app/pages/faqs/[...slug].vue` to implement all locked decisions for individual FAQ pages.

    Template (Pug) -- rebuild the template with these sections in order:

    1. **Breadcrumbs** at the top of the page (inside `section.section > .container`):
       ```pug
       nav.breadcrumb.mb-4(aria-label="breadcrumbs")
         ul
           li
             NuxtLink(to="/") Home
           li
             NuxtLink(to="/faqs") FAQs
           li.is-active
             a(aria-current="page") {{ faq.question }}
       ```
       Use Bulma's built-in `.breadcrumb` component. No custom breadcrumb component needed.

    2. **Question heading** styled distinctly -- larger and different color. Per decision: question styled distinctly, not necessarily the page H1. Use `h1.title.is-3.has-text-primary` for the question (the `is-3` size makes it prominent, `has-text-primary` gives it the brand color).

    3. **Subtle disclaimer text** below the question (not a banner or box -- small muted text):
       ```pug
       p.is-size-7.has-text-grey.mb-5
         | Community-sourced â€” not verified or endorsed.
         = ' '
         NuxtLink(to="/terms") Terms
       ```

    4. **Freshness indicator** -- keep the existing last-updated date display with calendar icon (same as Phase 2).

    5. **Rendered markdown content** -- keep `.content > ContentRenderer(:value="faq")` as-is.

    6. **Source attribution** -- implement multi-answer display:
       - If `faq.answers && faq.answers.length > 0`: Render each answer's source attribution stacked vertically with `hr` dividers between them. Each answer labeled by source (e.g., "From @ForumUser123 on IntegraForums"). Use `is-size-7.has-text-grey` for subtle styling. Include external link icon.
       - Else (legacy single-answer): Fall back to the existing source box using `faq.sourceUrl`, `faq.sourceAuthor`, `faq.sourceDate`.
       - For each source link, display the URL as-is. If the link might be broken, a "(link may be outdated)" note is not needed unless the link actually fails -- this is a future concern per deferred ideas.

    7. **"Back to FAQs" link** -- a text link above the sticky button area:
       ```pug
       .mt-5
         NuxtLink(to="/faqs")
           LucideArrowLeft(:size="16" style="vertical-align: middle;")
           |  Back to FAQs
       ```

    8. **Sticky "Back to FAQs" button on mobile** -- add at the bottom of the template (after the section):
       ```pug
       .back-to-faqs-mobile
         NuxtLink.button.is-primary.is-fullwidth(to="/faqs")
           LucideArrowLeft(:size="16")
           |  Back to FAQs
       ```

    Script (TypeScript setup):
    - Keep the existing `queryCollection('faqs').path(route.path).first()` query.
    - Keep the existing 404 handling.
    - Keep the existing `formatDate` function.
    - Add SEO meta: `useSeoMeta({ ogTitle: faq.value.question, ogDescription: faq.value.description || faq.value.question })` -- the `description` field is auto-populated by Nuxt Content from the first paragraph if not set in frontmatter.

    Scoped styles (add in the component's `<style scoped lang="scss">`):
    - Sticky mobile back button:
      ```scss
      .back-to-faqs-mobile {
        display: none;
        @media (max-width: 1023px) {
          display: block;
          position: sticky;
          bottom: 0;
          padding: 0.5rem 1rem;
          background: var(--bulma-scheme-main);
          border-top: 1px solid var(--bulma-border);
          z-index: 29;
        }
      }
      ```
    - Answer source divider styling if needed.

    Also update `app/assets/scss/main.scss` ONLY if global styles are needed. Most styles should be scoped to the component. If no global styles are needed, do not modify main.scss.

    Key considerations:
    - Content width follows Bulma container/column defaults (no custom max-width) per locked decision.
    - Dark mode follows Bulma defaults per locked decision.
    - Breadcrumb uses Bulma's `.breadcrumb` CSS class (not a custom component).
    - The `.back-to-faqs-mobile` uses `position: sticky; bottom: 0` (not fixed) per research recommendation -- stays in document flow, avoids content overlap.
    - z-index 29 for sticky button (below Bulma navbar's 30).
  </action>
  <verify>
    Run `yarn dev` and verify:
    - Navigate to /faqs, click any FAQ -- detail page loads with breadcrumbs, question heading, disclaimer, content, source attribution, and back link.
    - Multi-answer FAQ (oil-type-recommendation) shows per-answer source attributions with "From @username" labels.
    - Single-answer FAQs (break-in-period, warranty-coverage) show legacy source box.
    - Breadcrumbs show Home > FAQs > [Question] with working links.
    - "Back to FAQs" text link works.
    - On narrow viewport (< 1024px): sticky "Back to FAQs" button appears at bottom.
    - On wide viewport (>= 1024px): sticky button hidden.
    - Dark mode renders correctly (warm neutrals, readable text).
    - View page source or check meta tags: og:title and og:description set from FAQ content.
    Run `yarn lint` -- no errors.
    Run `yarn generate` -- SSG succeeds and FAQ routes are included in output.
  </verify>
  <done>
    FAQ detail page shows breadcrumbs, distinctly styled question, disclaimer, content, multi-answer source attribution (or legacy fallback), back-to-list link, sticky mobile back button, and SEO meta tags. Works in both light and dark modes. SSG generates all FAQ routes.
  </done>
</task>

</tasks>

<verification>
After both tasks:
1. `/faqs` shows flat list of FAQ questions sorted by most recent, with intro/disclaimer and empty state.
2. `/faqs/engine/oil-type-recommendation` shows multi-answer source attribution.
3. `/faqs/engine/break-in-period` shows single-answer source attribution (legacy).
4. Breadcrumbs work on detail pages: Home > FAQs > [Question].
5. Sticky mobile back button appears only on viewports < 1024px.
6. SEO meta tags (og:title, og:description) set on detail pages.
7. `yarn generate` produces all FAQ routes in output and sitemap.xml includes them.
8. `yarn lint` passes.
9. Dark mode renders correctly on all pages.
</verification>

<success_criteria>
- FAQ listing page at /faqs displays all curated questions with intro/disclaimer
- FAQ detail pages render content with multi-answer and single-answer source attribution
- Breadcrumb navigation works on detail pages
- Mobile sticky back button visible only on mobile
- SEO meta tags set from FAQ content
- SSG generates all FAQ routes successfully
</success_criteria>

<output>
After completion, create `.planning/phases/03-faq-display/03-02-SUMMARY.md`
</output>
