---
phase: 02-content-system
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - app/pages/faqs/[...slug].vue
  - app/components/SourceAttribution.vue
  - app/components/FreshnessIndicator.vue
autonomous: true

must_haves:
  truths:
    - "Navigating to /faqs/engine/oil-type-recommendation renders the FAQ markdown content"
    - "Source attribution displays as a clickable link showing author name and original post date"
    - "Last updated date is visible on the FAQ page"
    - "404 error shown when navigating to a non-existent FAQ path"
  artifacts:
    - path: "app/pages/faqs/[...slug].vue"
      provides: "Catch-all FAQ page route with content fetching, rendering, and metadata"
      contains: "queryCollection"
    - path: "app/components/SourceAttribution.vue"
      provides: "Reusable source citation display with external link, author, and date"
      contains: "sourceUrl"
    - path: "app/components/FreshnessIndicator.vue"
      provides: "Last updated date display with locale-aware formatting"
      contains: "Intl.DateTimeFormat"
  key_links:
    - from: "app/pages/faqs/[...slug].vue"
      to: "content/faqs/**/*.md"
      via: "queryCollection('faqs').path(route.path).first()"
      pattern: "queryCollection.*faqs"
    - from: "app/pages/faqs/[...slug].vue"
      to: "app/components/SourceAttribution.vue"
      via: "auto-imported component in Pug template"
      pattern: "SourceAttribution"
    - from: "app/pages/faqs/[...slug].vue"
      to: "app/components/FreshnessIndicator.vue"
      via: "auto-imported component in Pug template"
      pattern: "FreshnessIndicator"
    - from: "app/pages/faqs/[...slug].vue"
      to: "@nuxt/content ContentRenderer"
      via: "ContentRenderer component for markdown rendering"
      pattern: "ContentRenderer"
---

<objective>
Build the FAQ page route and display components for content rendering, source attribution, and freshness indicators.

Purpose: This is the user-facing layer that makes FAQ content accessible. Users navigate to a FAQ URL and see the rendered markdown answer with clear source attribution (who wrote it, where it came from) and freshness tracking (when it was last updated). This satisfies all four Phase 2 success criteria.

Output: Catch-all page route at `app/pages/faqs/[...slug].vue`, `SourceAttribution` component, and `FreshnessIndicator` component.
</objective>

<execution_context>
@/Users/rich/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rich/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-content-system/02-RESEARCH.md
@.planning/phases/02-content-system/02-01-SUMMARY.md
@content.config.ts
@app/layouts/default.vue
@app/pages/index.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SourceAttribution and FreshnessIndicator components</name>
  <files>app/components/SourceAttribution.vue, app/components/FreshnessIndicator.vue</files>
  <action>
Create two small display components following existing codebase patterns (Pug templates, script setup lang="ts", brief comments).

**FreshnessIndicator.vue:**
- Props: `date` (string, required) -- ISO date string from lastUpdated frontmatter
- Uses `Intl.DateTimeFormat('en-US', { year: 'numeric', month: 'long', day: 'numeric' })` for formatting
- Displays: calendar icon (LucideCalendar, size 14) + "Last updated: February 9, 2026"
- Bulma classes: `.is-size-7.has-text-grey` for subtle presentation
- Computed property for formatted date (not inline in template)

```pug
//- Freshness indicator showing when FAQ was last updated
p.is-size-7.has-text-grey
  LucideCalendar(:size="14" style="vertical-align: middle;")
  |  Last updated: {{ formattedDate }}
```

**SourceAttribution.vue:**
- Props: `url` (string, required), `author` (string, required), `date` (string, required)
- Same date formatting approach as FreshnessIndicator (Intl.DateTimeFormat)
- Displays in a Bulma `.box`: external link icon (LucideExternalLink, size 14) + "Source: AuthorName (linked to URL) . date"
- The author name is a clickable link with target="_blank" rel="noopener noreferrer"
- Bulma classes: `.box.mt-5` wrapper, `.is-size-7` for text

```pug
//- Source attribution box with link to original post
.box.mt-5
  p.is-size-7
    LucideExternalLink(:size="14" style="vertical-align: middle;")
    |  Source:&nbsp;
    a(:href="url" target="_blank" rel="noopener noreferrer") {{ author }}
    |  &middot; {{ formattedDate }}
```

Both components use `defineProps<{ ... }>()` TypeScript syntax.
  </action>
  <verify>
- `cat app/components/SourceAttribution.vue` shows Pug template, script setup, sourceUrl/author/date props
- `cat app/components/FreshnessIndicator.vue` shows Pug template, script setup, date prop, Intl.DateTimeFormat usage
- `grep "Intl.DateTimeFormat" app/components/FreshnessIndicator.vue` confirms date formatting
- `grep "Intl.DateTimeFormat" app/components/SourceAttribution.vue` confirms date formatting
- `yarn lint` passes without errors on the new components
  </verify>
  <done>SourceAttribution component renders source link with author and date; FreshnessIndicator component renders "Last updated" with formatted date; both use Pug templates and TypeScript props</done>
</task>

<task type="auto">
  <name>Task 2: Create catch-all FAQ page route</name>
  <files>app/pages/faqs/[...slug].vue</files>
  <action>
Create the catch-all page route that renders any FAQ by its URL path. Follow existing page patterns (see app/pages/index.vue for conventions).

**app/pages/faqs/[...slug].vue:**

Script setup section:
1. Get current route with `useRoute()`
2. Fetch FAQ using `queryCollection('faqs').path(route.path).first()` wrapped in `useAsyncData(route.path, ...)`
   - CRITICAL: Use `queryCollection` (v3 API), NOT `queryContent` (v2 API -- does not exist)
3. If `!faq.value`, throw 404: `throw createError({ statusCode: 404, statusMessage: 'FAQ not found' })`
4. Set page title from FAQ question: `useHead({ title: faq.value.question })`

Template section (Pug):
```pug
//- FAQ detail page with content, source attribution, and freshness
section.section(v-if="faq")
  .container
    //- FAQ question as page heading
    h1.title {{ faq.question }}

    //- Freshness indicator (last updated date)
    FreshnessIndicator(:date="faq.lastUpdated")

    //- Rendered markdown content (Bulma .content class for typography)
    .content
      ContentRenderer(:value="faq")

    //- Source attribution with link to original post
    SourceAttribution(
      :url="faq.sourceUrl"
      :author="faq.sourceAuthor"
      :date="faq.sourceDate"
    )
```

Layout: uses default layout (no explicit layout needed).

IMPORTANT notes:
- Components (SourceAttribution, FreshnessIndicator, ContentRenderer) are auto-imported by Nuxt -- no import statements needed
- Wrap ContentRenderer in `.content` div for Bulma typography styling
- The `faq` object from queryCollection includes all frontmatter fields defined in the schema
  </action>
  <verify>
- `yarn dev` starts without errors
- Visit `http://localhost:3000/faqs/engine/oil-type-recommendation` -- page renders with:
  - "What oil type does the Integra Type S require?" as heading
  - "Last updated: February 9, 2026" freshness indicator
  - Rendered markdown content with "0W-20" bold, capacity list, brands list
  - Source attribution box with link to integraforums.com, author "ForumUser123", and date
- Visit `http://localhost:3000/faqs/engine/break-in-period` -- renders second FAQ
- Visit `http://localhost:3000/faqs/general/paint-codes` -- renders third FAQ (different category)
- Visit `http://localhost:3000/faqs/nonexistent` -- shows 404 error
- `yarn lint` passes
  </verify>
  <done>Catch-all FAQ page route renders markdown content with ContentRenderer, displays source attribution as clickable link, shows last updated date, and returns 404 for missing FAQs</done>
</task>

</tasks>

<verification>
1. `yarn dev` starts cleanly -- no content or rendering errors
2. Navigate to `/faqs/engine/oil-type-recommendation`:
   - Question heading visible
   - "Last updated" date formatted and visible
   - Markdown body rendered with proper typography (Bulma .content)
   - Source attribution box shows clickable link to forum post, author name, date
3. Navigate to `/faqs/general/paint-codes` -- different category FAQ renders correctly
4. Navigate to `/faqs/does-not-exist` -- 404 error displayed
5. `yarn lint` passes on all new files
6. `yarn generate` succeeds (FAQ pages pre-rendered for SSG)
</verification>

<success_criteria>
- FAQ pages render at correct URL paths derived from content file locations
- Source attribution renders as clickable external link with author name and original date
- "Last updated" date is visible on every FAQ page
- 404 handling works for non-existent FAQ paths
- All code follows project conventions (Pug templates, TypeScript, Prettier formatting, brief comments)
</success_criteria>

<output>
After completion, create `.planning/phases/02-content-system/02-02-SUMMARY.md`
</output>
